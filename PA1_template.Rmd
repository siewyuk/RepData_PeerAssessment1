---
title: "Reproducible Research: Peer Assessment 1"
output: 
  html_document:
    keep_md: true
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

## Loading and preprocessing the data
```{r dat, echo = TRUE}
#Load required libraries
library(data.table)
library(ggplot2)
#Load csv data
dat <- data.table(read.csv("~/Downloads/activity.csv"))
```


## What is mean total number of steps taken per day?
```{r totalsteps, echo = TRUE}
#Ignore missing values in the dataset, use tapply on "steps" and sort by date. 
totalSteps <- tapply(dat$steps, dat$date, FUN = sum, na.rm = TRUE)
#Plot histogram and qplot
qplot(totalSteps, binwidth=3, xlab = "Total Number of Steps Taken Each Day", main = "Figure 1") + 
  geom_histogram(colour = "blue", fill= "blue")
mean(totalSteps, na.rm = TRUE)
median(totalSteps, na.rm = TRUE)
```

1. Average number of steps per day = ***9354.23***.
2. Median number of steps per day = ***10,395***


## What is the average daily activity pattern?
```{r averageSteps, echo = TRUE}
#Time series plot of 5-minute interval and average steps taken, on average across all days (y-axis)
averageSteps <- aggregate(x = list(steps = dat$steps), by = list(interval = dat$interval), FUN = mean, na.rm = TRUE)
ggplot(data = averageSteps, aes(x = interval, y = steps)) +
  geom_line(color = "blue", lwd = 2) + 
  xlab("5-minute Interval") + 
  ylab("Average Number of Steps Taken") + 
  labs(title = expression("Figure 2"))

#What is the maximum number of steps of 5-minute interval, averaged across all days?
averageSteps[which.max(averageSteps$steps),]
```

The 5-minute interval that contains the maximum averaged number of steps is 8:35 am (***835***).  
The maximum averaged number of steps is ***206.1698***


## Imputing missing values



## Are there differences in activity patterns between weekdays and weekends?
